<?php

return [

    /*
     * Enable / disable firewall
     *
     */

    'enabled' => env('FIREWALL_ENABLED', true),

    /*
     * Whitelisted and blacklisted IP addresses, ranges, countries, files and/or files of files
     *
     *  Examples of IP address, hosts, country codes and CIDRs
     *      '127.0.0.1',
     *      '192.168.17.0/24'
     *      '127.0.0.1/255.255.255.255'
     *      '10.0.0.1-10.0.0.255'
     *      '172.17.*.*'
     *      'country:br'
     *      'host:google.com',
     *      storage_path().DIRECTORY_SEPARATOR.'blacklisted.txt', // a file with IPs, one per line
     */

    'blacklist' => [
        '203.135.96.0/19',
        '203.208.32.0/19',
        '202.165.176.0/20',
        '59.108.0.0/14',
        '210.25.0.0/16',
        '202.95.252.0/22',
        '219.216.0.0/13',
        '202.170.128.0/19',
        '60.247.0.0/16',
        '221.13.0.0/16',
        '125.96.0.0/15',
        '202.38.0.0/20',
        '203.192.0.0/19',
        '202.122.128.0/24',
        '218.56.0.0/13',
        '203.166.160.0/19',
        '202.122.112.0/21',
        '203.190.96.0/20',
        '219.72.0.0/16',
        '124.172.0.0/15',
        '210.79.64.0/18',
        '198.17.7.0/24',
        '202.168.160.0/19',
        '203.91.120.0/21',
        '220.160.0.0/11',
        '202.127.192.0/20',
        '202.127.216.0/21',
        '60.253.128.0/17',
        '58.82.0.0/15',
        '202.85.208.0/20',
        '124.249.0.0/16',
        '202.90.224.0/20',
        '59.192.0.0/10',
        '192.83.122.0/24',
        '202.38.152.0/22',
        '202.69.16.0/20',
        '210.14.128.0/17',
        '124.240.0.0/17',
        '222.240.0.0/13',
        '221.176.0.0/13',
        '203.191.16.0/20',
        '124.200.0.0/13',
        '202.60.112.0/20',
        '203.94.0.0/19',
        '221.12.0.0/17',
        '221.14.0.0/15',
        '202.152.176.0/20',
        '121.4.0.0/15',
        '210.82.0.0/15',
        '203.152.64.0/19',
        '121.76.0.0/15',
        '59.191.0.0/17',
        '221.196.0.0/15',
        '202.165.208.0/20',
        '125.254.128.0/18',
        '210.14.64.0/19',
        '203.212.80.0/20',
        '202.112.0.0/13',
        '58.87.64.0/18',
        '61.45.128.0/18',
        '122.51.0.0/16',
        '210.32.0.0/12',
        '202.93.252.0/22',
        '202.90.0.0/22',
        '125.216.0.0/13',
        '222.64.0.0/11',
        '60.194.0.0/15',
        '210.23.32.0/19',
        '124.196.0.0/16',
        '203.158.16.0/21',
        '192.124.154.0/24',
        '122.0.128.0/17',
        '203.208.16.0/22',
        '202.127.16.0/20',
        '202.38.184.0/21',
        '210.192.96.0/19',
        '210.56.192.0/19',
        '202.173.224.0/19',
        '222.125.0.0/16',
        '202.20.120.0/24',
        '58.32.0.0/11',
        '202.164.0.0/20',
        '210.5.0.0/19',
        '202.8.128.0/19',
        '202.150.16.0/20',
        '203.86.64.0/19',
        '202.63.248.0/22',
        '203.174.96.0/19',
        '220.252.0.0/16',
        '210.185.192.0/18',
        '203.156.192.0/18',
        '203.110.160.0/19',
        '203.95.0.0/21',
        '222.16.0.0/12',
        '59.172.0.0/15',
        '202.38.136.0/23',
        '121.224.0.0/12',
        '203.191.64.0/18',
        '221.129.0.0/16',
        '121.40.0.0/14',
        '210.21.0.0/16',
        '59.151.0.0/17',
        '202.170.216.0/21',
        '203.130.32.0/19',
        '121.100.128.0/17',
        '202.127.12.0/22',
        '124.254.0.0/18',
        '203.135.160.0/20',
        '124.250.0.0/15',
        '202.14.88.0/24',
        '202.181.112.0/20',
        '202.38.160.0/23',
        '219.242.0.0/15',
        '203.191.144.0/20',
        '220.242.0.0/15',
        '61.29.128.0/17',
        '221.133.224.0/19',
        '203.196.0.0/21',
        '202.0.176.0/22',
        '122.0.64.0/18',
        '220.154.0.0/15',
        '222.168.0.0/13',
        '220.248.0.0/14',
        '218.185.192.0/19',
        '124.160.0.0/13',
        '202.38.168.0/21',
        '121.56.0.0/15',
        '121.55.0.0/18',
        '202.91.128.0/22',
        '121.59.0.0/16',
        '123.49.128.0/17',
        '220.232.64.0/18',
        '203.100.32.0/20',
        '202.122.32.0/21',
        '202.38.138.0/24',
        '202.14.235.0/24',
        '203.171.224.0/20',
        '202.4.252.0/22',
        '124.224.0.0/12',
        '202.38.128.0/21',
        '121.51.0.0/16',
        '202.127.112.0/20',
        '166.111.0.0/16',
        '124.108.40.0/21',
        '203.207.128.0/17',
        '218.104.0.0/14',
        '58.30.0.0/15',
        '124.156.0.0/16',
        '202.14.236.0/23',
        '125.31.192.0/18',
        '203.90.128.0/18',
        '124.66.0.0/17',
        '202.136.208.0/20',
        '210.16.128.0/18',
        '221.0.0.0/13',
        '203.128.32.0/19',
        '61.128.0.0/10',
        '58.116.0.0/14',
        '202.130.0.0/19',
        '192.83.169.0/24',
        '202.94.0.0/19',
        '202.46.32.0/19',
        '60.232.0.0/15',
        '61.87.192.0/18',
        '203.222.42.64/26',
        '60.255.0.0/16',
        '124.20.0.0/15',
        '121.32.0.0/13',
        '202.38.140.0/22',
        '203.184.80.0/20',
        '58.144.0.0/16',
        '210.15.0.0/17',
        '124.68.0.0/14',
        '219.128.0.0/11',
        '121.204.0.0/14',
        '202.127.128.0/19',
        '218.64.0.0/11',
        '124.108.8.0/21',
        '125.213.0.0/17',
        '202.74.8.0/21',
        '61.236.0.0/15',
        '61.48.0.0/13',
        '219.224.0.0/12',
        '121.0.16.0/20',
        '125.98.0.0/16',
        '222.192.0.0/11',
        '202.180.128.0/19',
        '121.89.0.0/16',
        '202.96.0.0/12',
        '203.100.80.0/20',
        '203.88.192.0/19',
        '121.248.0.0/14',
        '221.200.0.0/13',
        '202.38.158.0/23',
        '202.38.149.0/24',
        '162.105.0.0/16',
        '210.15.128.0/18',
        '221.172.0.0/14',
        '125.215.0.0/18',
        '218.192.0.0/12',
        '202.131.48.0/20',
        '202.92.252.0/22',
        '220.192.0.0/12',
        '202.38.146.0/23',
        '203.95.96.0/19',
        '202.69.4.0/22',
        '58.128.0.0/13',
        '203.118.192.0/19',
        '203.128.96.0/19',
        '202.136.224.0/20',
        '222.126.128.0/17',
        '122.200.64.0/18',
        '61.8.160.0/20',
        '202.38.150.0/23',
        '58.192.0.0/11',
        '203.212.0.0/20',
        '124.248.0.0/17',
        '222.128.0.0/12',
        '203.92.0.0/22',
        '202.38.192.0/18',
        '221.199.224.0/19',
        '210.79.224.0/19',
        '202.91.0.0/22',
        '221.224.0.0/12',
        '203.208.0.0/20',
        '203.207.64.0/18',
        '202.149.160.0/19',
        '202.149.224.0/19',
        '202.189.80.0/20',
        '203.80.144.0/20',
        '58.66.0.0/15',
        '202.70.0.0/19',
        '210.78.0.0/16',
        '203.209.224.0/19',
        '202.131.16.0/21',
        '58.24.0.0/15',
        '202.179.240.0/20',
        '202.4.128.0/19',
        '202.14.238.0/24',
        '222.176.0.0/12',
        '222.160.0.0/14',
        '220.112.0.0/14',
        '167.139.0.0/16',
        '122.4.0.0/14',
        '202.153.48.0/20',
        '221.12.128.0/18',
        '211.144.0.0/12',
        '211.64.0.0/13',
        '124.6.64.0/18',
        '125.112.0.0/12',
        '203.83.56.0/21',
        '124.29.0.0/17',
        '124.16.0.0/15',
        '202.136.48.0/20',
        '61.47.128.0/18',
        '124.40.128.0/18',
        '202.127.212.0/22',
        '203.148.0.0/18',
        '59.64.0.0/12',
        '122.48.0.0/16',
        '124.42.0.0/17',
        '218.249.0.0/16',
        '124.242.0.0/16',
        '203.132.32.0/19',
        '203.79.0.0/20',
        '202.38.176.0/23',
        '202.43.144.0/20',
        '202.123.96.0/20',
        '203.175.192.0/18',
        '125.171.0.0/16',
        '211.136.0.0/13',
        '203.128.128.0/19',
        '192.188.170.0/24',
        '122.8.0.0/13',
        '124.67.0.0/16',
        '202.91.176.0/20',
        '124.243.192.0/18',
        '221.122.0.0/15',
        '203.90.0.0/22',
        '210.28.0.0/14',
        '202.122.64.0/19',
        '220.231.0.0/18',
        '210.52.0.0/15',
        '220.234.0.0/16',
        '202.38.164.0/22',
        '202.127.224.0/19',
        '203.81.16.0/20',
        '202.127.48.0/20',
        '134.196.0.0/16',
        '218.0.0.0/11',
        '60.63.0.0/16',
        '203.93.0.0/16',
        '124.72.0.0/13',
        '61.240.0.0/14',
        '202.127.40.0/21',
        '202.127.208.0/23',
        '125.210.0.0/16',
        '211.96.0.0/13',
        '61.28.0.0/17',
        '60.235.0.0/16',
        '202.158.160.0/19',
        '121.46.0.0/15',
        '59.80.0.0/14',
        '203.176.168.0/21',
        '121.60.0.0/14',
        '202.143.16.0/20',
        '58.154.0.0/15',
        '221.208.0.0/12',
        '210.51.0.0/16',
        '218.108.0.0/15',
        '61.232.0.0/14',
        '121.201.0.0/16',
        '124.88.0.0/13',
        '221.198.0.0/16',
        '203.161.192.0/19',
        '203.119.32.0/22',
        '202.38.156.0/24',
        '202.92.0.0/22',
        '221.130.0.0/15',
        '168.160.0.0/16',
        '222.32.0.0/11',
        '203.86.0.0/18',
        '121.16.0.0/12',
        '203.92.160.0/19',
        '202.46.224.0/20',
        '121.8.0.0/13',
        '59.107.0.0/16',
        '203.91.96.0/20',
        '122.198.0.0/16',
        '221.8.0.0/14',
        '219.82.0.0/16',
        '202.93.0.0/22',
        '60.55.0.0/16',
        '125.64.0.0/11',
        '203.187.160.0/19',
        '58.14.0.0/15',
        '124.64.0.0/15',
        '202.38.64.0/18',
        '125.58.128.0/17',
        '203.119.24.0/21',
        '203.100.192.0/20',
        '202.165.96.0/20',
        '202.160.176.0/20',
        '221.192.0.0/14',
        '202.120.0.0/15',
        '203.100.96.0/19',
        '202.127.160.0/21',
        '202.75.208.0/20',
        '125.62.0.0/18',
        '124.220.0.0/14',
        '202.91.224.0/19',
        '202.10.64.0/20',
        '202.90.252.0/22',
        '202.127.0.0/21',
        '220.231.128.0/17',
        '60.208.0.0/12',
        '218.96.0.0/14',
        '203.222.192.0/20',
        '60.200.0.0/13',
        '210.87.128.0/18',
        '125.208.0.0/18',
        '210.22.0.0/16',
        '125.32.0.0/12',
        '121.58.0.0/17',
        '202.136.252.0/22',
        '221.199.0.0/17',
        '203.99.16.0/20',
        '203.175.128.0/19',
        '203.91.32.0/19',
        '210.76.0.0/15',
        '60.245.128.0/17',
        '121.192.0.0/14',
        '203.89.0.0/22',
        '220.152.128.0/17',
        '210.72.0.0/14',
        '58.16.0.0/13',
        '202.0.110.0/24',
        '121.68.0.0/14',
        '202.41.152.0/21',
        '202.131.208.0/20',
        '221.199.192.0/20',
        '203.223.0.0/20',
        '124.112.0.0/13',
        '202.125.176.0/20',
        '203.90.192.0/19',
        '123.99.128.0/17',
        '221.199.128.0/18',
        '60.0.0.0/11',
        '202.142.16.0/20',
        '161.207.0.0/16',
        '202.130.224.0/19',
        '159.226.0.0/16',
        '210.5.128.0/19',
        '58.100.0.0/15',
        '124.47.0.0/18',
        '221.136.0.0/15',
        '218.240.0.0/13',
        '203.134.240.0/21',
        '58.240.0.0/12',
        '202.141.160.0/19',
        '210.12.0.0/15',
        '203.88.32.0/19',
        '202.148.96.0/19',
        '202.95.0.0/19',
        '222.248.0.0/15',
        '211.160.0.0/13',
        '203.99.80.0/20',
        '60.160.0.0/11',
        '202.41.240.0/20',
        '122.49.0.0/18',
        '211.80.0.0/12',
        '123.199.128.0/17',
        '202.192.0.0/12',
        '202.22.248.0/21',
        '219.244.0.0/14',
        '202.122.0.0/21',
        '59.32.0.0/11',
        '125.104.0.0/13',
        '124.192.0.0/15',
        '124.147.128.0/17',
        '124.128.0.0/13',
        '202.173.8.0/21',
        '210.26.0.0/15',
        '121.48.0.0/15',
        '220.101.192.0/18',
    ],

    'whitelist' => [
        '192.168.6.216'
    ],

    /*
     * Response action for blocked responses
     *
     */

    'responses' => [
        'blacklist' => [
            'code' => 403, // 200 = log && notify, but keep pages rendering

            'message' => null,

            'view' => null,

            'redirect_to' => null,

            'abort' => false, // return abort() instead of Response::make() - disabled by default
        ],

        'whitelist' => [
            'code' => 403, // 200 = log && notify, but keep pages rendering

            'message' => null,

            'view' => null,

            'redirect_to' => null,

            'abort' => false, // return abort() instead of Response::make() - disabled by default
        ],
    ],

    /*
     * Do you wish to redirect non whitelisted accesses to an error page?
     *
     * You can use a route name (coming.soon) or url (/coming/soon);
     *
     */

    'redirect_non_whitelisted_to' => 'coming/soon',

    /*
     * How long should we keep IP addresses in cache?
     *
     * This is a general client IP addresses cache. When the user hits your system his/her IP address
     * is searched and cached for the desired time. Finding an IP address contained in a CIDR
     * range (172.17.0.0/24, for instance) can be a "slow", caching it improves performance.
     *
     */

    'cache_expire_time' => 60, // minutes

    /*
     * How long should we keep lists of IP addresses in cache?
     *
     * This is the list cache. Database lists can take some time to load and process,
     * caching it, if you are not making frequent changes to your lists, may improve firewall speed a lot.
     */

    'ip_list_cache_expire_time' => 0, // minutes - disabled by default

    /*
     * Send suspicious events to log?
     *
     */

    'enable_log' => true,

    'log_stack' => null,

    /*
     * Search by range allow you to store ranges of addresses in
     * your black and whitelist:
     *
     *   192.168.17.0/24 or
     *   127.0.0.1/255.255.255.255 or
     *   10.0.0.1-10.0.0.255 or
     *   172.17.*.*
     *
     * Note that range searches may be slow and waste memory, this is why
     * it is disabled by default.
     *
     */

    'enable_range_search' => true,

    /*
     * Search by country range allow you to store country ids in your
     * your black and whitelist:
     *
     *   php artisan firewall:whitelist country:us
     *   php artisan firewall:blacklist country:cn
     *
     */

    'enable_country_search' => true,

    /*
     * Should Firewall use the database?
     */

    'use_database' => true,

    /*
     * Models
     *
     * When using the "eloquent" driver, we need to know which Eloquent models
     * should be used.
     *
     */

    'firewall_model' => 'PragmaRX\Firewall\Vendor\Laravel\Models\Firewall',

    /*
     * Session object binding in the IoC Container
     *
     * When blacklisting IPs for the current session, Firewall
     * will need to instantiate the session object.
     *
     */

    'session_binding' => 'session',

    /*
     * GeoIp2 database path.
     *
     * To get a fresh version of this file, use the command
     *
     *      php artisan firewall:updategeoip
     *
     */

    'geoip_database_path' => __DIR__.'/geoip', //storage_path('geoip'),

    /*
     * Block suspicious attacks
     */

    'attack_blocker' => [

        'enabled' => [
            'ip' => true,

            'country' => true,
        ],

        'cache_key_prefix' => 'firewall-attack-blocker',

        'allowed_frequency' => [

            'ip' => [
                'requests' => 50,

                'seconds' => 1 * 60, // 1 minute
            ],

            'country' => [
                'requests' => 3000,

                'seconds' => 2 * 60, // 2 minutes
            ],

        ],

        'action' => [

            'ip' => [
                'blacklist_unknown' => true,

                'blacklist_whitelisted' => false,
            ],

            'country' => [
                'blacklist_unknown' => false,

                'blacklist_whitelisted' => false,
            ],

        ],

        'response' => [
            'code' => 403, // 200 = log && notify, but keep pages rendering

            'message' => null,

            'view' => null,

            'redirect_to' => null,

            'abort' => false, // return abort() instead of Response::make() - disabled by default
        ],

    ],

    'notifications' => [
        'enabled' => true,

        'message' => [
            'title' => 'User agent',

            'message' => "A possible attack on '%s' has been detected from %s",

            'request_count' => [
                'title' => 'Request count',

                'message' => 'Received %s requests in the last %s seconds. Timestamp of first request: %s',
            ],

            'uri' => [
                'title' => 'First URI offended',
            ],

            'blacklisted' => [
                'title' => 'Was it blacklisted?',
            ],

            'user_agent' => [
                'title' => 'User agent',
            ],

            'geolocation' => [
                'title' => 'Geolocation',

                'field_latitude' => 'Latitude',

                'field_longitude' => 'Longitude',

                'field_country_code' => 'Country code',

                'field_country_name' => 'Country name',

                'field_city' => 'City',
            ],
        ],

        'route' => '',

        'from' => [
            'name' => 'Laravel Firewall',

            'address' => 'firewall@mydomain.com',

            'icon_emoji' => ':fire:',
        ],

        'users' => [
            'model' => PragmaRX\Firewall\Vendor\Laravel\Models\User::class,

            'emails' => [
                'admin@mydomain.com',
            ],
        ],

        'channels' => [
            'slack' => [
                'enabled' => true,
                'sender'  => PragmaRX\Firewall\Notifications\Channels\Slack::class,
            ],

            'mail' => [
                'enabled' => true,
                'sender'  => PragmaRX\Firewall\Notifications\Channels\Mail::class,
            ],
        ],
    ],
];
